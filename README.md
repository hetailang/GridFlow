# GridFlow - 动态拼图生成器

基于网格布局的交互式图片拼接工具，支持实时调整布局和导出高清拼图。

## 使用示例

主界面演示
![主界面演示](./figure/image.png)

导出
![alt text](./figure/output.png)

## ✨ 核心功能

### 1. 多种上传方式
- 📷 **拖放上传** - 直接拖放图片文件到网格区域
- 🖱️ **点击选择** - 点击区域打开文件浏览器
- ⌨️ **剪贴板粘贴** - 使用 Ctrl+V 直接粘贴截图

### 2. 灵活的布局系统
- 支持 1-9 张图片的多种布局模式
- **可拖动边框** - 拖动分隔线实时调整每个区域的大小
- 智能初始布局（左一右二、2x2网格、2x3网格等）

### 3. 图片管理
- ✕ **删除功能** - 鼠标悬停时在图片右上角显示删除按钮
- 🎯 **智能裁剪** - 自动 Center Crop 填充容器

### 4. 样式自定义
- 调整图片间距（0-50px）
- 设置圆角大小（0-50px）
- 自定义背景颜色
- 多种画布比例（16:9、4:3、1:1、9:16、3:4）

### 5. 高清导出
- 💾 导出为 2400px 宽度的高清 PNG 图片
- 保持所有样式设置和布局比例

## 🚀 快速开始

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

访问 http://localhost:3000/

### 构建生产版本
```bash
npm run build
```

## 🎯 使用方法

1. **选择图片数量** - 在右侧控制面板选择要拼接的图片数量
2. **添加图片** - 通过拖放、点击或粘贴方式添加图片
3. **调整布局** - 拖动图片之间的分隔线调整区域大小
4. **自定义样式** - 调整间距、圆角、背景色等参数
5. **删除图片** - 鼠标悬停在图片上，点击右上角的删除按钮
6. **导出拼图** - 点击"导出图片"按钮下载最终作品

## 🛠 技术栈

- **React 18** - UI 框架
- **Vite 5** - 构建工具
- **Canvas API** - 图片渲染和导出
- **原生 CSS** - 样式设计

## 📝 项目结构

```
GridFlow/
├── src/
│   ├── components/
│   │   ├── ImageCell.jsx       # 图片单元格组件
│   │   ├── GridLayout.jsx      # 网格布局组件
│   │   ├── Divider.jsx         # 可拖动分隔线组件
│   │   └── ControlPanel.jsx    # 控制面板组件
│   ├── utils/
│   │   └── exportCanvas.js     # 导出功能
│   ├── App.jsx                 # 主应用组件
│   └── main.jsx                # 应用入口
├── index.html
├── vite.config.js
└── package.json
```

## 🎨 新增功能说明

### 删除图片
- 当鼠标悬停在已上传的图片上时，右上角会显示一个删除按钮（✕）
- 点击删除按钮即可清除该区域的图片
- 删除按钮采用圆形设计，悬停时变为红色

### 可调整布局
- 在支持的布局模式（2-8图）中，图片之间会显示可拖动的分隔线
- 鼠标悬停在分隔线上时会显示蓝色高亮和拖动手柄
- 拖动分隔线可以实时调整相邻区域的大小比例
- 比例范围限制在 20%-80% 之间，确保每个区域都有合理的显示空间
- 导出时会保持实际调整后的布局比例

## 📒 Changelog

### 2026-02-17

#### 新增：复制图片到剪贴板

在控制面板导出区域新增「📋 复制图片」按钮，可将当前拼图直接复制到系统剪贴板，方便粘贴到微信、飞书、Figma 等应用中，无需先下载文件。

- 按钮带有状态反馈：复制中 → 已复制 / 复制失败，2 秒后自动重置
- 使用绿色渐变样式，与蓝紫色的导出按钮区分

<details>
<summary>实现细节</summary>

- 从 `exportToImage` 中提取公共的 `renderToCanvas()` 函数，复用 Canvas 渲染逻辑
- 新增 `copyToClipboard()` 导出函数，通过 `navigator.clipboard.write` + `ClipboardItem` 将 PNG 写入剪贴板
- 需要浏览器支持 Clipboard API（主流现代浏览器均已支持）

</details>

#### 修复：Ctrl+V 粘贴图片会填充所有网格

之前每个 `ImageCell` 都在 `document` 上注册了 `paste` 监听器，导致粘贴时所有网格同时接收图片。现已修复为仅将图片粘贴到鼠标悬停的网格中。

<details>
<summary>实现细节</summary>

- 在 `ImageCell` 中新增 `isHovered` 状态，通过 `onMouseEnter` / `onMouseLeave` 追踪鼠标位置
- `paste` 事件处理函数中增加 `if (!isHovered) return` 守卫，仅悬停的 cell 响应粘贴

</details>

## 📋 TODO

- [ ] **自由布局模式** - 支持非对齐网格拼图，图片区域可以独立定位，不受严格行列对齐约束，适合突出核心内容的创意排版。可选方案：
  - 预定义模板：新增非对齐布局模板，用嵌套 Flex/Grid 实现（低成本）
  - 绝对定位引擎：每个区域用 `{x, y, width, height}` 自由定位（需重写布局引擎）
  - 自动排版算法：根据图片尺寸/权重自动计算最优布局（高复杂度）

## 📄 许可证

ISC
